Fx.Scroll.Carousel=new Class({Extends:Fx.Scroll,options:{mode:"horizontal",childSelector:!1,loopOnScrollEnd:!0},initialize:function(b,e){this.parent(b,e);this.cacheElements();this.currentIndex=0},cacheElements:function(){var b=this.options.childSelector;this.elements=els=b?this.element.getElements(b):this.options.mode=="horizontal"?this.element.getElements(":first-child > *"):this.element.getChildren();return this},toFirst:function(){if(this.checkLink())return this;this.currentIndex=0;this.toElement(this.elements[this.currentIndex]);
return this},toNext:function(){if(this.checkLink())return this;this.currentIndex=this.getNextIndex();this.toElement(this.elements[this.currentIndex]);this.fireEvent("next");return this},toPrevious:function(){if(this.checkLink())return this;this.currentIndex=this.getPreviousIndex();this.toElement(this.elements[this.currentIndex]);this.fireEvent("previous");return this},getNextIndex:function(){this.currentIndex++;return this.currentIndex==this.elements.length||this.checkScroll()?(this.fireEvent("loop"),
this.fireEvent("nextLoop"),0):this.currentIndex},getPreviousIndex:function(){this.currentIndex--;var b=this.checkScroll();return this.currentIndex<0||b?(this.fireEvent("loop"),this.fireEvent("previousLoop"),b?this.getOffsetIndex():this.elements.length-1):this.currentIndex},getOffsetIndex:function(){return this.currentIndex+1-(this.options.mode=="horizontal"?this.element.getStyle("width").toInt()/this.elements[0].getStyle("width").toInt():this.element.getStyle("height").toInt()/this.elements[0].getStyle("height").toInt())},
checkLink:function(){return this.timer&&this.options.link=="ignore"},checkScroll:function(){if(!this.options.loopOnScrollEnd)return!1;if(this.options.mode=="horizontal")var b=this.element.getScroll().x,e=this.element.getScrollSize().x-this.element.getSize().x;else b=this.element.getScroll().y,e=this.element.getScrollSize().y-this.element.getSize().y;return b==e},getCurrent:function(){return this.elements[this.currentIndex]}});
var Boxart=new Class({boxarts:[],container:"",previousArrow:"",NextArrow:"",params:{},saved:{},initialize:function(b,e){this.params=new Hash(b);this.saved=new Hash(e);this.container=document.id("boxarts");this.previousArrow=document.id("previous");this.NextArrow=document.id("next");this.Carousel=new Fx.Scroll.Carousel("boxarts",{mode:"horizontal",loopOnScrollEnd:!1,childSelector:".inner .boxart_holder"});this.NextArrow.addEvent("click",function(){this.Carousel.toNext()}.bind(this));this.previousArrow.addEvent("click",
function(){this.Carousel.toPrevious()}.bind(this));this.platforms=document.id("jform_platforms");this.platforms.addEvent("change",function(){this.updateBoxarts()}.bind(this));this.updateBoxarts();this.modal=SqueezeBox.initialize()},updateBoxarts:function(){this.platforms.getChildren().each(function(b){b.selected&&!this.hasBoxart(b.value)&&b.value!=0&&this.addBoxart(b.value,b.innerHTML);!b.selected&&this.hasBoxart(b.value)&&b.value!=0&&this.removeBoxart(b.value);this.centralizeArrows()},this)},centralizeArrows:function(){var b=
this.container.getSize().y,b=b>0?(b-40)/2:0;this.previousArrow.setStyle("margin-top",b);this.NextArrow.setStyle("margin-top",b)},hasBoxart:function(b){return this.boxarts.contains(b)},addBoxart:function(b,e){var f=this.params.get(b),d=this.saved.get(b),h=d==""||typeof d=="object"?f.default_boxart:d,j=h.replace(/(\.jpg)$/i,"_thumb$1"),i=new Element("div",{"class":"boxart_holder",id:"boxart_"+b}),h=(new Element("a",{href:"../"+h})).inject(i);SqueezeBox.assign(h);(new Element("img",{alt:e,src:"../"+
j,width:f.width||null,height:f.height||null})).inject(h);(new Element("div",{"class":"clr"})).inject(i);(new Element("input",{type:"hidden",id:"jform_boxart_path_"+b,value:d,name:"jform[boxarts]["+b+"]"})).inject(i);f=(new Element("a",{"class":"modal hasTip",href:"index.php?option=com_media&view=images&tmpl=component&fieldid=jform_boxart_path_"+b+"&folder=",rel:"{handler: 'iframe', size: {x: 800, y: 500}}",html:"Add Boxart"})).inject(i);f.store("tip:title","Add Boxart");f.store("tip:text","Add Boxart for "+
e);new Tips(f);SqueezeBox.assign(f,{parse:"rel"});i.inject("boxarts_inner","top");$("boxarts").getParent("div").setStyle("height","100%");this.Carousel.cacheElements();this.Carousel.toFirst();this.boxarts.include(b)},removeBoxart:function(b){$("boxart_"+b).dissolve({duration:1E3,onComplete:function(b){b.destroy();this.centralizeArrows();this.Carousel.cacheElements()}.bind(this)});this.boxarts.erase(b)}});
(function(b,e){var f=Browser;Object.append(Element.NativeEvents,{paste:2,input:2});Element.Events.paste={base:f.opera||f.firefox&&f.version<3?"input":"paste",condition:function(a){this.fireEvent("paste",a,1);return!1}};Element.Events.keyrepeat={base:f.firefox||f.opera?"keypress":"keydown",condition:Function.from(!0)};var d=b.Meio||{},h,j={9:1,16:1,17:1,18:1,224:1,91:1,37:1,38:1,39:1,40:1},i=function(a){return a.replace(/"/g,"&quot;").replace(/'/g,"&#39;")};d.Widget=new Class({initialize:function(){this.elements=
{}},addElement:function(a,c){this.elements[a]=c},addEventToElement:function(a,c,g){this.elements[a].addEvent(c,g.bind(this))},addEventsToElement:function(a,c){for(var g in c)this.addEventToElement(a,g,c[g])},attach:function(){for(var a in this.elements)this.elements[a].attach()},detach:function(){for(var a in this.elements)this.elements[a].detach()},destroy:function(){for(var a in this.elements)this.elements[a]&&this.elements[a].destroy()}});d.Autocomplete=new Class({Extends:d.Widget,Implements:[Options,
Events],options:{delay:200,minChars:0,cacheLength:20,selectOnTab:!0,maxVisibleItems:10,cacheType:"shared",filter:{},fieldOptions:{},listOptions:{},requestOptions:{},urlOptions:{}},initialize:function(a,c,g,b){this.parent();this.setOptions(g);this.active=0;this.filters=d.Autocomplete.Filter.get(this.options.filter);this.addElement("list",b||new d.Element.List(this.options.listOptions));this.addListEvents();this.addElement("field",new d.Element.Field(a,this.options.fieldOptions));this.addFieldEvents();
this.addSelectEvents();this.attach();this.initCache();this.initData(c)},addFieldEvents:function(){this.addEventsToElement("field",{beforeKeyrepeat:function(a){this.active=1;var c=a.key,g=this.elements.list;(c=="up"||c=="down"||c=="enter"&&g.showing)&&a.preventDefault()},delayedKeyrepeat:function(a){var a=a.key,c=this.elements.field;c.keyPressControl[a]=!0;switch(a){case "up":case "down":this.focusItem(a);break;case "enter":this.setInputValue();break;case "tab":this.options.selectOnTab&&this.setInputValue();
c.keyPressControl[a]=!1;break;case "esc":this.elements.list.hide();break;default:this.setupList()}this.oldInputedText=c.node.get("value")},keyup:function(a){var c=this.elements.field;j[a.code]||(c.keyPressControl[a.key]||this.setupList(),c.keyPressControl[a.key]=!1)},focus:function(){this.active=1;var a=this.elements.list;a.focusedItem=null;a.positionNextTo(this.elements.field.node)},click:function(){++this.active>2&&!this.elements.list.showing&&this.forceSetupList()},blur:function(){this.active=
0;var a=this.elements.list;a.shouldNotBlur?(this.elements.field.node.setCaretPosition("end"),a.shouldNotBlur=!1,a.focusedItem&&a.hide()):a.hide()},paste:function(){return this.setupList()}})},addListEvents:function(){this.addEventsToElement("list",{mousedown:function(a){this.active&&!a.dontHide&&this.setInputValue()}})},update:function(){var a=this.data,c=this.elements.list,g=a.getKey(),b=this.cache.get(g);if(b)a=b.html,this.itemsData=b.data;else{for(var a=a.get(),d=[],b=[],e=c.options.classes,f=
this.inputedText,h=this.filters.filter,j=this.filters.formatMatch,m=this.filters.formatItem,k,n=0,l=0;k=a[n++];)h.call(this,f,k)&&(d.push('<li title="',i(j.call(this,f,k)),'" data-index="',l,'" class="',l%2?e.even:e.odd,'">',m.call(this,f,k,l),"</li>"),b.push(k),l++);a=d.join("");this.cache.set(g,{html:a,data:b});this.itemsData=b}c.focusedItem=null;this.fireEvent("deselect",[this.elements]);c.list.set("html",a);this.options.maxVisibleItems&&c.applyMaxHeight(this.options.maxVisibleItems)},setupList:function(){this.inputedText=
this.elements.field.node.get("value");this.inputedText!==this.oldInputedText?this.forceSetupList(this.inputedText):this.elements.list.hide();return!0},forceSetupList:function(a){a=a||this.elements.field.node.get("value");if(a.length>=this.options.minChars)clearInterval(this.prepareTimer),this.prepareTimer=this.data.prepare.delay(this.options.delay,this.data,this.inputedText)},dataReady:function(){this.update();if(this.onUpdate)this.onUpdate(),this.onUpdate=null;var a=this.elements.list;a.list.get("html")?
this.active&&a.show():(this.fireEvent("noItemToList",[this.elements]),a.hide())},setInputValue:function(){var a=this.elements.list;if(a.focusedItem){var c=a.focusedItem.get("title");this.elements.field.node.set("value",c);var g=a.focusedItem.get("data-index");this.fireEvent("select",[this.elements,this.itemsData[g],c,g])}a.hide()},focusItem:function(a){var c=this.elements.list;c.showing?c.focusItem(a):(this.forceSetupList(),this.onUpdate=function(){c.focusItem(a)})},addSelectEvents:function(){this.addEvents({select:function(a){a.field.addClass("selected")},
deselect:function(a){a.field.removeClass("selected")}})},initData:function(a){this.data=typeOf(a)=="string"?new d.Autocomplete.Data.Request(a,this.cache,this.elements.field,this.options.requestOptions,this.options.urlOptions):new d.Autocomplete.Data(a,this.cache);this.data.addEvent("ready",this.dataReady.bind(this))},initCache:function(){var a=this.options.cacheLength;this.options.cacheType=="shared"?(this.cache=h,this.cache.setMaxLength(a)):this.cache=new d.Autocomplete.Cache(a)},refreshCache:function(a){this.cache.refresh();
this.cache.setMaxLength(a||this.options.cacheLength)},refreshAll:function(a,c){this.refreshCache(a);this.data.refreshKey(c)}});d.Autocomplete.Select=new Class({Extends:d.Autocomplete,options:{syncName:"id",valueField:null,valueFilter:function(a){return a.id}},initialize:function(a,c,g,b){this.parent(a,c,g,b);(this.valueField=e(this.options.valueField))&&this.syncWithValueField(c)},syncWithValueField:function(a){var c=this.getValueFromValueField();c&&this.options.syncName?(this.addParameter(a),this.addDataReadyEvent(c),
this.data.prepare(this.elements.field.node.get("value"))):this.addValueFieldEvents()},addValueFieldEvents:function(){this.addEvents({select:function(a,c){this.valueField.set("value",this.options.valueFilter.call(this,c))},deselect:function(){this.valueField.set("value","")}})},addParameter:function(){this.parameter={name:this.options.syncName,value:function(){return this.valueField.value}.bind(this)};this.data.url&&this.data.url.addParameter(this.parameter)},addDataReadyEvent:function(a){var c=this,
g=function(){c.addValueFieldEvents();for(var b=this.get(),d=b.length;d--;)if(c.options.valueFilter.call(c,b[d])==a){var e=c.filters.formatMatch.call(c,"",b[d],0);c.elements.field.node.set("value",e);c.fireEvent("select",[c.elements,b[d],e,d]);break}this.url&&this.url.removeParameter(c.parameter);this.removeEvent("ready",g)};this.data.addEvent("ready",g)},getValueFromValueField:function(){return this.valueField.get("value")}});d.Autocomplete.Select.One=new Class({Extends:d.Autocomplete.Select,options:{filter:{path:"text"}},
initialize:function(a,c,b){this.select=e(a);this.replaceSelect();this.parent(this.field,this.createDataArray(),Object.merge(c||{},{valueField:this.select,valueFilter:function(a){return a.value}}),b)},replaceSelect:function(){var a=this.select.getSelected()[0];this.field=new Element("input",{type:"text"});var c=a.get("value");(c||c===0)&&this.field.set("value",a.get("html"));this.select.setStyle("display","none");this.field.inject(this.select,"after")},createDataArray:function(){for(var a=this.select.options,
c=[],b=0,d,e;d=a[b++];)((e=d.value)||e===0)&&c.push({value:e,text:d.innerHTML});return c},addValueFieldEvents:function(){this.addEvents({select:function(a,c){var b=this.valueField.getElement('option[value="'+this.options.valueFilter.call(this,c)+'"]');if(b)b.selected=!0},deselect:function(){var a=this.valueField.getSelected()[0];if(a)a.selected=!1}})},getValueFromValueField:function(){return this.valueField.getSelected()[0].get("value")}});d.Element=new Class({Implements:[Events],initialize:function(a){this.setNode(a);
this.createBoundEvents();this.attach()},setNode:function(a){this.node=a?e(a)||$$(a)[0]:this.render()},createBoundEvents:function(){this.bound={};this.boundEvents.each(function(a){this.bound[a]=function(c){this.fireEvent("before"+a.capitalize(),c);this[a]&&this[a](c);this.fireEvent(a,c);return!0}.bind(this)},this)},attach:function(){for(var a in this.bound)this.node.addEvent(a,this.bound[a])},detach:function(){for(var a in this.bound)this.node.removeEvent(a,this.bound[a])},addClass:function(a){this.node.addClass(this.options.classes[a])},
removeClass:function(a){this.node.removeClass(this.options.classes[a])},toElement:function(){},render:function(){}});d.Element.Field=new Class({Extends:d.Element,Implements:[Options],options:{classes:{loading:"ma-loading",selected:"ma-selected"}},initialize:function(a,c){this.keyPressControl={};this.boundEvents=["paste","focus","blur","click","keyup","keyrepeat"];f.ie6&&this.boundEvents.push("keypress");this.setOptions(c);this.parent(a);e(b).addEvent("unload",function(){this.node&&this.node.set("autocomplete",
"on")}.bind(this))},setNode:function(a){this.parent(a);this.node.set("autocomplete","off")},keyrepeat:function(a){clearInterval(this.keyrepeatTimer);this.keyrepeatTimer=this._keyrepeat.delay(1,this,a)},_keyrepeat:function(a){this.fireEvent("delayedKeyrepeat",a)},destroy:function(){this.detach();this.node.removeAttribute("autocomplete")},keypress:function(a){a.key=="enter"&&this.bound.keyrepeat(a)}});d.Element.List=new Class({Extends:d.Element,Implements:[Options],options:{width:"field",classes:{container:"ma-container",
hover:"ma-hover",odd:"ma-odd",even:"ma-even"}},initialize:function(a){this.boundEvents=["mousedown","mouseover"];this.setOptions(a);this.parent();this.focusedItem=null},applyMaxHeight:function(a){var c=this.list.childNodes;if(a=c[a-1]||(c.length?c[c.length-1]:null)){a=e(a);for(c=2;c--;)this.node.setStyle("height",a.getCoordinates(this.list).bottom)}},mouseover:function(a){var a=this.getItemFromEvent(a),c=this.options.classes.hover;if(!a)return!0;this.focusedItem&&this.focusedItem.removeClass(c);a.addClass(c);
this.focusedItem=a;this.fireEvent("focusItem",[this.focusedItem])},mousedown:function(a){a.preventDefault();this.shouldNotBlur=!0;if(!(this.focusedItem=this.getItemFromEvent(a)))return a.dontHide=!0;this.focusedItem.removeClass(this.options.classes.hover)},focusItem:function(a){var c=this.options.classes.hover,b;if(this.focusedItem){if(b=this.focusedItem[a=="up"?"getPrevious":"getNext"]())this.focusedItem.removeClass(c),b.addClass(c),this.focusedItem=b,this.scrollFocusedItem(a)}else if(b=this.list.getFirst())b.addClass(c),
this.focusedItem=b},scrollFocusedItem:function(a){var c=this.focusedItem.getCoordinates(this.list),b=this.node.scrollTop;if(a=="down"){if(a=c.bottom-this.node.getStyle("height").toInt(),a-b>0)this.node.scrollTop=a}else if(a=c.top,b&&b>a)this.node.scrollTop=a},getItemFromEvent:function(a){for(a=a.target;a&&a.tagName.toLowerCase()!="li";){if(a===this.node)return null;a=a.parentNode}return e(a)},render:function(){var a=new Element("div",{"class":this.options.classes.container});a.bgiframe&&a.bgiframe({top:0,
left:0});this.list=(new Element("ul")).inject(a);e(document.body).grab(a);return a},positionNextTo:function(a){var c=this.options.width,b=this.node,d=a.getCoordinates();b.setStyle("width",c=="field"?a.getWidth().toInt()-b.getStyle("border-left-width").toInt()-b.getStyle("border-right-width").toInt():c);b.setPosition({x:d.left,y:d.bottom})},show:function(){this.node.scrollTop=0;this.node.setStyle("visibility","visible");this.showing=!0},hide:function(){this.showing=!1;this.node.setStyle("visibility",
"hidden")}});d.Autocomplete.Filter={filters:{},get:function(a){var c=a.type,b=(a.path||"").split("."),a=c&&this.filters[c]?this.filters[c](this,b):a;return Object.merge(this.defaults(b),a)},define:function(a,c){this.filters[a]=c},defaults:function(a){var c=this;return{filter:function(b,d){return b?c._getValueFromKeys(d,a).test(RegExp(b.escapeRegExp(),"i")):!0},formatMatch:function(b,d){return c._getValueFromKeys(d,a)},formatItem:function(b,d){return b?c._getValueFromKeys(d,a).replace(RegExp("("+b.escapeRegExp()+
")","gi"),"<strong>$1</strong>"):c._getValueFromKeys(d,a)}}},_getValueFromKeys:function(a,c){for(var b,d=a,e=0;b=c[e++];)d=d[b];return d}};d.Autocomplete.Filter.define("contains",function(){return{}});d.Autocomplete.Filter.define("startswith",function(a,c){return{filter:function(b,d){return b?a._getValueFromKeys(d,c).test(RegExp("^"+b.escapeRegExp(),"i")):!0}}});d.Autocomplete.Data=new Class({Implements:[Options,Events],initialize:function(a,c){this._cache=c;this.data=a;this.dataString=JSON.encode(this.data)},
get:function(){return this.data},getKey:function(){return this.cachedKey},prepare:function(a){this.cachedKey=this.dataString+(a||"");this.fireEvent("ready")},cache:function(a,c){this._cache.set(a,c)},refreshKey:function(){}});d.Autocomplete.Data.Request=new Class({Extends:d.Autocomplete.Data,options:{noCache:!0,formatResponse:function(a){return a}},initialize:function(a,c,b,d,e){this.setOptions(d);this.rawUrl=a;this._cache=c;this.element=b;this.urlOptions=e;this.refreshKey();this.createRequest()},
prepare:function(a){this.cachedKey=this.url.evaluate(a);this._cache.has(this.cachedKey)?this.fireEvent("ready"):this.request.send({url:this.cachedKey})},createRequest:function(){var a=this;this.request=new Request.JSON(this.options);this.request.addEvents({request:function(){a.element.addClass("loading")},complete:function(){a.element.removeClass("loading")},success:function(c){a.data=a.options.formatResponse(c);a.fireEvent("ready")}})},refreshKey:function(a){a=Object.merge(this.urlOptions,{url:this.rawUrl},
a||{});this.url=new d.Autocomplete.Data.Request.URL(a.url,a)}});d.Autocomplete.Data.Request.URL=new Class({Implements:[Options],options:{queryVarName:"q",extraParams:null,max:20},initialize:function(a,c){this.setOptions(c);this.url=this.rawUrl=a;this.url+=this.url.contains("?")?"&":"?";this.dynamicExtraParams=[];for(var b=Array.from(this.options.extraParams),d=b.length;d--;)this.addParameter(b[d]);this.options.max&&this.addParameter("limit="+this.options.max)},evaluate:function(a){var b=this.dynamicExtraParams,
d=[];d.push(this.options.queryVarName+"="+encodeURIComponent(a||""));for(a=b.length;a--;)d.push(encodeURIComponent(b[a].name)+"="+encodeURIComponent(Function.from(b[a].value)()));return this.url+d.join("&")},addParameter:function(a){a.nodeType==1||typeOf(a.value)=="function"?this.dynamicExtraParams.push(a):this.url+=(typeOf(a)=="string"?a:encodeURIComponent(a.name)+"="+encodeURIComponent(a.value))+"&"},removeParameter:function(a){this.dynamicExtraParams.erase(a)}});d.Autocomplete.Cache=new Class({initialize:function(a){this.refresh();
this.setMaxLength(a)},set:function(a,b){if(!this.cache[a]){if(this.getLength()>=this.maxLength){var d=this.pos.shift();this.cache[d]=null;delete this.cache[d]}this.cache[a]=b;this.pos.push(a)}return this},get:function(a){return this.cache[a||""]||null},has:function(a){return!!this.get(a)},getLength:function(){return this.pos.length},refresh:function(){this.cache={};this.pos=[]},setMaxLength:function(a){this.maxLength=Math.max(a,1)}});h=new d.Autocomplete.Cache;b.Meio=d})(this,document.id||$);
window.addEvent("domready",function(){new Meio.Autocomplete(document.id("jform_developer"),"index.php?option=com_games&controller=ajax&w=developer&format=json");new Meio.Autocomplete(document.id("jform_publisher"),"index.php?option=com_games&controller=ajax&w=publisher&format=json");new Meio.Autocomplete(document.id("jform_serie"),"index.php?option=com_games&controller=ajax&w=serie&format=json");$$(".rating").each(function(b){b.addEvent("click:relay(a.select)",function(e,f){e.stop();b.getElements("a.select.selected").removeClass("selected");
f.addClass("selected");b.getElement("input").set("value",this.get("data-value"))})});document.id("content").addEvent("click:relay(a.select)",function(b,e){e.hasClass("selected")?(e.removeClass("selected"),e.getElement("input").checked=!1):(e.addClass("selected"),e.getElement("input").checked=!0);b.stop()})});jInsertFieldValue=function(b,e){var f=document.id(e),d=f.getParent("div");f.set("value",b);d.getElement("img").set("src","../"+b);d.getElement("a").set("href","../"+b)};